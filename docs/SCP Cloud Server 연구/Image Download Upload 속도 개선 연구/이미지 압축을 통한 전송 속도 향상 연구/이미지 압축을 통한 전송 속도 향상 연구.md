# 비손실 압축

- 비손실 압축 기술
    - JPEG-LS 보다는 JPEG 2000(Lossless Mode)이 적합하다.
    - 압축률: 평균 2:1 ~ 3:1
    - CT와 MRI에 적합
- JPEG 2000 비손실 압축 기술
    - WebViewer가 서버로 압축해서 전송하려면?
        - WASM 등을 이용해야 빠르게 압축할 수 있을 것이다.
        - TBD
    - Download시
        - 서버에서 압축하여 Client 전송
            - Python의 Pillow, OpenJPEG 라이브러리 이용
            - Node.js에서 Node-OpenJPEG 이용
        - 서버에 압축된 파일을 저장
            - 1안. 원본 + 압축본 저장
                
                ![(thumbs up)](https://vks.vatech.com/s/-w74hgg/8804/xgjkrn/_/images/icons/emoticons/thumbs_up.svg)
                
                - 빠름
                - 추가 용량 필요
            - 2안. 원본만 저장 + 실시간 압축
                - 느림
- JPEG 2000 압축 해제
    - WebViewer가 JPEG 2000 압축된 이미지를 해제하려면
        - WASM 등을 이용해야 빠르게 압축 해제할 수 있을 것이다.
    - 표시
        - HTML5 Canvas or WebGL

# 손실 압축

- DICOM 이미지/CT를 Web에서 보기 위한 목적이라면 손실 압축도 좋은 선택이다.
- 사용자에게 손실 압축이라는 고지한다.
- 원본 이미지(비손실 압축)를 보기 전에 Preview로 이미지를 빠르게 보는 용도로 사용한다.
- 손실 압축 사용 여부는 Clinic의 사용자(관리자)가 결정할 수 있다.
- 손실 압축 기술
    - JPEG 2000 (Lossy Mode)이 적합하다.
    - 압축률: 15:1 ~ 50:1. 10:1 ~ 20:1에서 좋은 품질 유지
    - DICOM 파일에 적합
- JPEG 2000 손실 압축 기술
    - 위 비손실 압축과 동일하다.
    - 서버에 압축된 파일을 저장
        - 1안. 원본 + 비손실압축본 + 손실압축본 저장
            
            ![(thumbs up)](https://vks.vatech.com/s/-w74hgg/8804/xgjkrn/_/images/icons/emoticons/thumbs_up.svg)
            
        - 2안. 원본 + 비손실압축본
        - 3안. 원본 + 손실압축본
        - 4안. 원본만 저장
        - 전략장점단점적합한 경우1안다양한 활용 시나리오 지원, 빠른 조회 가능높은 스토리지 비용, 관리 복잡도모든 요구 충족, 고품질/웹뷰 모두 필요2안원본 보존 + 고품질 이미지 지원, 스토리지 절감웹뷰 시 추가 손실 압축 필요, 실시간 변환 시 속도 저하원본 보존 + 고품질이 필요한 경우3안원본 보존 + 빠른 웹 전송 가능, 비용 절감고품질 이미지 사용 시 속도 저하, 분석 용도 부적합원본 보존 + 웹뷰 필요, 고품질 요구 낮은 경우4안스토리지 비용 절감, 관리 용이실시간 압축 부하 큼, 전송 속도 느림저렴한 비용, 전송 속도 요구 낮은 경우
    - Thumbnail 포함
        - 원본 + 비손실압축본 + 손실압축본 + Thumbnail

# 기타

- Downloading 속도 향상
    - WebSocket 이용
    - HTTP/2 이용
    - Local Cache 이용
        - 별도 페이지 ([Image Caching 연구](https://vks.vatech.com/pages/viewpage.action?pageId=199922044))
    - 서비스 리전에 따른 Downloading 속도
- **묶음 관리 여부, 묶음시의 압축 여부 검토도 필요하다 (zip / tar)**
    
    ![(warning)](https://vks.vatech.com/s/-w74hgg/8804/xgjkrn/_/images/icons/emoticons/warning.svg)
    
    - **Todo**
    - CT인 경우
    - 낱장 이미지와 CT는 별도 정책이 필요하다.